model TrafficSourceAccount {
    id         Int      @id @default(autoincrement())
    createDate DateTime @default(now())
    updateDate DateTime @default(now()) @updatedAt

    trafficSourceType   TrafficSourceType
    externalId          String
    name                String
    externalStatus      String
    externalCreatedTime DateTime
    status              TrafficSourceAccountStatus?
    balance             Decimal                     @db.Decimal(18, 2)
    externalCurrency    String
    externalTimezone    String
    spendCap            Decimal                     @db.Decimal(18, 2)
    amountSpent         Decimal                     @db.Decimal(18, 2)
    isActive            Boolean                     @default(true)

    trafficSourceOwnerBmId Int?
    trafficSourceOwnerBm   TrafficSourceBm? @relation(fields: [trafficSourceOwnerBmId], references: [id])

    trafficSourceAccountToTrafficSourceBmConnections TrafficSourceAccountToTrafficSourceBm[]
    trafficSourceDailyAdStats                        TrafficSourceDailyAdStat[]

    @@unique([trafficSourceType, externalId])
    @@map("traffic_source_account")
}

enum TrafficSourceAccountStatus {
    ACTIVE
    BLOCK
    PAYMENT_ERROR
    CLOSING
    EXPIRED
}

enum TrafficSourceType {
    FACEBOOK
    TIKTOK
}

model TrafficSourceAccountToTrafficSourceBm {
    id         Int      @id @default(autoincrement())
    createDate DateTime @default(now())
    updateDate DateTime @default(now()) @updatedAt

    trafficSourceBmId      Int
    trafficSourceBm        TrafficSourceBm      @relation(fields: [trafficSourceBmId], references: [id], onDelete: Cascade)
    trafficSourceAccountId Int
    trafficSourceAccount   TrafficSourceAccount @relation(fields: [trafficSourceAccountId], references: [id], onDelete: Cascade)

    @@unique([trafficSourceBmId, trafficSourceAccountId])
    @@map("traffic_source_account_to_traffic_source_bm")
}
